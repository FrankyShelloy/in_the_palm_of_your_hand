<!doctype html>
<html lang="ru">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>–ù–∞–õ–∞–¥–æ–Ω–∏</title>
  <link rel="stylesheet" href="/styles.css" />
  <script src="/theme.js"></script>
</head>
<body>
  <header class="topbar">
    <div class="brand">
      <span class="brand-initial">–ù</span>–∞<span class="brand-initial">–õ</span>–∞–¥–æ–Ω–∏
    </div>
    <div class="auth-actions" id="auth-actions">
      <div class="theme-switcher">
        <button class="theme-btn" data-theme="light" title="–°–≤–µ—Ç–ª–∞—è —Ç–µ–º–∞">‚òÄ</button>
        <button class="theme-btn" data-theme="dark" title="–¢—ë–º–Ω–∞—è —Ç–µ–º–∞">üåô</button>
        <button class="theme-btn" data-theme="system" title="–°–∏—Å—Ç–µ–º–Ω–∞—è —Ç–µ–º–∞">üíª</button>
      </div>
      <button id="btn-show-login" class="ghost">–í—Ö–æ–¥</button>
      <button id="btn-show-register" class="primary">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      <div id="user-info" class="user-info hidden"></div>
      <button id="btn-show-ratings" class="icon-btn hidden" title="–ü–æ–∫–∞–∑–∞—Ç—å —Ä–µ–π—Ç–∏–Ω–≥">üèÜ</button>
      <a id="btn-admin-panel" href="/admin.html" class="icon-btn hidden" title="–ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å">‚öôÔ∏è</a>
      <button id="topbar-profile-toggle" class="icon-btn hidden" title="–ü–æ–∫–∞–∑–∞—Ç—å/–°–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å">üë§</button>
      <button id="btn-logout" class="ghost hidden">–í—ã—Ö–æ–¥</button>
    </div>
  </header>

  <main class="layout">
    <div class="top-row">
        <section class="panel wide" id="map-panel">
          <div class="panel-header">
            <h2>–ö–∞—Ä—Ç–∞</h2>
            <div class="header-controls">
                <span class="tag">–¢—É–ª—å—Å–∫–∞—è –æ–±–ª–∞—Å—Ç—å</span>
            </div>
          </div>
          <div class="map-container-wrapper">
            <div id="map"></div>

            <div class="map-controls-container">
                <!-- –ü–∞–Ω–µ–ª—å —Ñ–∏–ª—å—Ç—Ä–æ–≤ -->
                <div id="filters">
                    <div class="filters-header" id="filters-toggle">
                        <h4>–û–±—ä–µ–∫—Ç—ã –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h4>
                        <span class="arrow">‚ñº</span>
                    </div>
                    <div id="filters-content">
                        <label><input type="checkbox" data-type="pharmacy" checked> –ê–ø—Ç–µ–∫–∏ üíä</label>
                        <label><input type="checkbox" data-type="health_center" checked> –¶–µ–Ω—Ç—Ä—ã –∑–¥–æ—Ä–æ–≤—å—è ü©∫</label>
                        <label><input type="checkbox" data-type="hospital" checked> –ë–æ–ª—å–Ω–∏—Ü—ã üè•</label>
                        <label><input type="checkbox" data-type="dentist" checked> –°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏–∏ ü¶∑</label>
                        <label><input type="checkbox" data-type="lab" checked> –õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏–∏ üî¨</label>
                        <label><input type="checkbox" data-type="clinic" checked> –ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∏ üè®</label>
                        <label><input type="checkbox" data-type="other_med" checked> –î—Ä—É–≥–∏–µ –º–µ–¥. —É—á—Ä–µ–∂–¥–µ–Ω–∏—è ‚öïÔ∏è</label>
                        <label><input type="checkbox" data-type="healthy_food" checked> –ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ üçè</label>
                        <label><input type="checkbox" data-type="alcohol" checked> –ê–ª–∫–æ–≥–æ–ª—å / —Ç–∞–±–∞–∫ üç∑</label>
                        <label><input type="checkbox" data-type="gym" checked> –°–ø–æ—Ä—Ç / –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è</label>
                    </div>
                </div>

                <!-- –ö–Ω–æ–ø–∫–∞ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
                <button id="add-place-btn" class="primary"><span class="btn-icon">‚ûï</span> <span class="btn-text">–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç</span></button>
            </div>
          </div>
        </section>

        <section class="panel panel-hidden" id="profile-panel">
          <div class="panel-header">
            <div class="header-content">
              <h2>–ü—Ä–æ—Ñ–∏–ª—å</h2>
              <span class="tag" id="profile-level">–£—Ä–æ–≤–µ–Ω—å 1</span>
            </div>
            <button id="profile-close" class="icon-btn" title="–°–∫—Ä—ã—Ç—å –ø—Ä–æ—Ñ–∏–ª—å">‚úñ</button>
          </div>
          <div class="profile-body">
            <div class="stat">
              <span class="label">Email</span>
              <span id="profile-email" class="value">-</span>
            </div>
            <div class="stat">
              <span class="label">–ò–º—è</span>
              <span id="profile-name" class="value">-</span>
            </div>
            <div class="stat">
              <span class="label">–û—Ç–∑—ã–≤—ã</span>
              <span id="profile-reviews" class="value">0</span>
            </div>
            <div class="stat">
              <span class="label">üèÜ –û—á–∫–∏</span>
              <span id="profile-points" class="value" style="color:#fbbf24;font-weight:bold;">0</span>
            </div>
          </div>
          
          <!-- Collapsible Reviews -->
          <div class="profile-section">
            <div class="section-header" id="toggle-reviews">
                <h3>–ú–æ–∏ –æ—Ç–∑—ã–≤—ã</h3>
                <span class="arrow">‚ñº</span>
            </div>
            <div id="user-reviews-container" class="section-content">
                <div id="user-reviews-list" class="reviews-list-small"></div>
            </div>
          </div>

          <!-- Collapsible Achievements -->
          <div class="profile-section">
            <div class="section-header" id="toggle-achievements">
                <h3>–î–æ—Å—Ç–∏–∂–µ–Ω–∏—è</h3>
                <span class="arrow">‚ñº</span>
            </div>
            <div id="user-achievements-container" class="section-content">
                <ul id="achievements-list" class="list compact-list"></ul>
            </div>
          </div>
        </section>
    </div>

    <section class="panel wide" id="object-reviews-panel">
      <div class="panel-header">
        <h2 id="object-reviews-title">–û—Ç–∑—ã–≤—ã –æ–± –æ–±—ä–µ–∫—Ç–µ</h2>
        <button id="object-reviews-close" class="icon-btn hidden-desktop" title="–ó–∞–∫—Ä—ã—Ç—å">‚úñ</button>
      </div>
      <div id="object-reviews-content">
        <p class="hint">–í—ã–±–µ—Ä–∏—Ç–µ –æ–±—ä–µ–∫—Ç –Ω–∞ –∫–∞—Ä—Ç–µ, —á—Ç–æ–±—ã —É–≤–∏–¥–µ—Ç—å –æ—Ç–∑—ã–≤—ã.</p>
      </div>
    </section>
  </main>

  <div class="modal hidden" id="modal-auth">
    <div class="modal-content">
      <div class="tabs">
        <button data-tab="login" class="tab active">–í—Ö–æ–¥</button>
        <button data-tab="register" class="tab">–†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è</button>
      </div>
      <form id="login-form" class="stack" data-mode="login">
        <label class="field">
          <span>Email</span>
          <input type="email" id="login-email" required />
        </label>
        <label class="field">
          <span>–ü–∞—Ä–æ–ª—å</span>
          <input type="password" id="login-password" required />
        </label>
        <div id="login-error" class="status"></div>
        <button type="submit" class="primary">–í–æ–π—Ç–∏</button>
        <button type="button" id="btn-forgot-password" class="ghost" style="margin-top: 0.5rem;">–ó–∞–±—ã–ª–∏ –ø–∞—Ä–æ–ª—å?</button>
      </form>
      <form id="register-form" class="stack hidden" data-mode="register">
        <label class="field">
          <span>Email</span>
          <input type="email" id="register-email" required />
        </label>
        <label class="field">
          <span>–ü–∞—Ä–æ–ª—å</span>
          <input type="password" id="register-password" minlength="6" required />
        </label>
        <label class="field">
          <span>–ò–º—è</span>
          <input type="text" id="register-name" />
        </label>
        <div id="register-error" class="status"></div>
        <button type="submit" class="primary">–ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞—Ç—å—Å—è</button>
      </form>
      <div style="margin-top:12px; display:flex; gap:8px;">
        <button id="btn-vk-login" class="primary" style="flex:1; background:#4C75A3;">–í–æ–π—Ç–∏ —á–µ—Ä–µ–∑ VK</button>
      </div>
      <button id="modal-close" class="ghost close">–ó–∞–∫—Ä—ã—Ç—å</button>
    </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è -->
  <div id="add-place-modal">
      <div>
          <h3>–î–æ–±–∞–≤–∏—Ç—å –æ–±—ä–µ–∫—Ç –∏–Ω—Ñ—Ä–∞—Å—Ç—Ä—É–∫—Ç—É—Ä—ã</h3>
          <label>–ù–∞–∑–≤–∞–Ω–∏–µ:</label>
          <input type="text" id="place-name" placeholder="–ù–∞–ø—Ä–∏–º–µ—Ä: –ê–ø—Ç–µ–∫–∞ '–£–ª—ã–±–∫–∞'">

          <label>–¢–∏–ø:</label>
          <select id="place-type">
              <option value="healthy_food">–ó–¥–æ—Ä–æ–≤–æ–µ –ø–∏—Ç–∞–Ω–∏–µ üçè</option>
              <option value="alcohol">–ê–ª–∫–æ–≥–æ–ª—å / —Ç–∞–±–∞–∫ üç∑</option>
              <option value="pharmacy">–ê–ø—Ç–µ–∫–∞ üíä</option>
              <option value="health_center">–¶–µ–Ω—Ç—Ä –∑–¥–æ—Ä–æ–≤—å—è ü©∫</option>
              <option value="hospital">–ë–æ–ª—å–Ω–∏—Ü–∞ üè•</option>
              <option value="dentist">–°—Ç–æ–º–∞—Ç–æ–ª–æ–≥–∏—è ü¶∑</option>
              <option value="lab">–õ–∞–±–æ—Ä–∞—Ç–æ—Ä–∏—è üî¨</option>
              <option value="clinic">–ü–æ–ª–∏–∫–ª–∏–Ω–∏–∫–∞ üè®</option>
              <option value="gym">–°–ø–æ—Ä—Ç / –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å üèãÔ∏è</option>
              <option value="other_med">–î—Ä—É–≥–æ–µ (–º–µ–¥.) ‚öïÔ∏è</option>
          </select>

          <div style="margin-top:16px; display:flex; gap:10px;">
              <button id="submit-place" style="flex:1; padding:8px; background:#2196F3; color:white; border:none; border-radius:4px;">–î–æ–±–∞–≤–∏—Ç—å</button>
              <button id="cancel-place" style="flex:1; padding:8px; background:#ccc; border:none; border-radius:4px;">–û—Ç–º–µ–Ω–∞</button>
          </div>
      </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ –æ—Ç–∑—ã–≤–∞ -->
  <div id="review-modal">
      <div>
          <h3>–û—Ü–µ–Ω–∏—Ç–µ –æ–±—ä–µ–∫—Ç</h3>
          <p id="review-place-name" style="margin:8px 0; font-weight:bold;"></p>

          <div id="star-rating" style="display:flex; margin:12px 0;">
              <span data-value="1" style="font-size:28px; cursor:pointer;">‚òÜ</span>
              <span data-value="2" style="font-size:28px; cursor:pointer;">‚òÜ</span>
              <span data-value="3" style="font-size:28px; cursor:pointer;">‚òÜ</span>
              <span data-value="4" style="font-size:28px; cursor:pointer;">‚òÜ</span>
              <span data-value="5" style="font-size:28px; cursor:pointer;">‚òÜ</span>
          </div>

          <label>–ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ):</label>
          <textarea id="review-comment" placeholder="–†–∞—Å—Å–∫–∞–∂–∏—Ç–µ –ø–æ–¥—Ä–æ–±–Ω–µ–µ..."></textarea>

          <label style="display:block; margin-top:12px;">–§–æ—Ç–æ (–Ω–µ–æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ, –º–∞–∫—Å. 5MB):</label>
          <input type="file" id="review-photo" accept="image/jpeg,image/png,image/webp,image/gif" style="margin:8px 0;">
          <div id="photo-preview" style="display:none; margin:8px 0;">
              <img id="photo-preview-img" style="max-width:200px; max-height:150px; border-radius:8px;">
              <button type="button" id="remove-photo" style="margin-left:8px; padding:4px 8px; background:#ff5252; color:white; border:none; border-radius:4px;">‚úï</button>
          </div>

          <div style="margin-top:16px; display:flex; gap:10px;">
              <button id="submit-review" style="flex:1; padding:8px; background:#FF9800; color:white; border:none; border-radius:4px;">–û—Ç–ø—Ä–∞–≤–∏—Ç—å</button>
              <button id="cancel-review" style="flex:1; padding:8px; background:#ccc; border:none; border-radius:4px;">–û—Ç–º–µ–Ω–∞</button>
          </div>
      </div>
  </div>

  <!-- –ú–æ–¥–∞–ª—å–Ω–æ–µ –æ–∫–Ω–æ —Ä–µ–π—Ç–∏–Ω–≥–∞ -->
  <div id="ratings-modal" style="display:none; position:fixed; top:0; left:0; right:0; bottom:0; background:rgba(0,0,0,0.5); z-index:1000; overflow-y:auto;">
      <div style="position:relative; background:var(--bg); margin:20px auto; padding:20px; padding-top:40px; max-width:500px; border-radius:8px; box-shadow:0 2px 10px rgba(0,0,0,0.2);">
          <button type="button" id="close-ratings" style="position:absolute; top:8px; right:8px; background:none; border:none; font-size:24px; cursor:pointer; padding:4px; width:32px; height:32px; display:flex; align-items:center; justify-content:center;">‚úï</button>
          <h2 style="margin-top:0; margin-bottom:16px;">üèÜ –†–µ–π—Ç–∏–Ω–≥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π</h2>
          
          <div id="ratings-list" style="margin:20px 0;">
              <div style="color:var(--text-secondary);">–ó–∞–≥—Ä—É–∑–∫–∞...</div>
          </div>

          <div id="current-user-rating" style="margin-top:20px; padding:12px; background:var(--bg-secondary); border-radius:4px; border:2px solid var(--accent); display:none;">
              <div style="font-size:14px; color:var(--text-secondary);">–í–∞—à–∞ –ø–æ–∑–∏—Ü–∏—è</div>
              <div style="font-size:18px; font-weight:bold; margin-top:4px;">
                  <span id="user-rank"></span>. <span id="user-name"></span> ‚Äî <span id="user-points"></span> –æ—á–∫–æ–≤
              </div>
          </div>
      </div>
  </div>

  <!-- Yandex Maps API -->
  <script src="https://api-maps.yandex.ru/2.1/?apikey=87e01821-8363-499b-a7d4-e5679708fc84&lang=ru_RU" type="text/javascript"></script>

  <!-- –û—Å–Ω–æ–≤–Ω–æ–π —Å–∫—Ä–∏–ø—Ç -->
  <script src="app.js"></script>
</body>
</html>

